(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{126:function(e,t){},168:function(e,t,r){},170:function(e,t,r){"use strict";r.r(t);var a=r(4),n=r(1),c=r(22),s=r.n(c),i=r(16),o=(r(93),r(94),r(95),r(8)),d=r(179),u=r(180),l=(r(96),r(183));r(97);var b=Object(l.a)("card",{canDrag:function(e){return!0},isDragging:function(e,t){return t.getItem()._id===e._id},beginDrag:function(e,t,r){return e},endDrag:function(e,t,r){if(t.didDrop())t.getItem(),t.getDropResult()}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.content,r=e.isDragging?0:1;return(0,e.connectDragSource)(Object(a.jsx)("div",{className:"tile",style:{opacity:r},children:Object(a.jsx)("img",{src:t})}))})),p=r(184);r(98);var j=Object(p.a)("card",{canDrop:function(e,t){return!0},hover:function(e,t,r){t.getClientOffset(),t.isOver({shallow:!0}),t.canDrop()},drop:function(e,t,r){if(!t.didDrop()){var a=t.getItem();if(a.boardId!==e._id)return e.onUpdate(a,e),{moved:!0}}}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),isOverCurrent:t.isOver({shallow:!0}),canDrop:t.canDrop(),itemType:t.getItemType()}}))((function(e){var t=e.isOver;e.canDrop;return(0,e.connectDropTarget)(Object(a.jsxs)("div",{className:t?"card hovered":"card",children:[Object(a.jsx)("header",{children:e.title||"Board"}),Object(a.jsx)("div",{className:"list scrollbar scroll-style-2 flex-container flex-wrap",children:e.tiles.map((function(t){return Object(a.jsx)(b,Object(o.a)({boardId:e._id},t),t._id)}))})]}))})),h=r(11),f=r.n(h),m=r(17),O=r(29),x=r(185),g=r(172),v=r(173),y=r(174),w=r(175),D=r(176),N=r(177),k=r(178),_=(r(100),r(129)),I=r(131)(),S=_().configure(I.fetch(window.fetch)).configure(_.authentication({storage:window.localStorage})),C=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M();case 3:return t=e.sent,e.abrupt("return",{client:S,user:t.user});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(m.a)(f.a.mark((function e(t){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=7;break}return e.next=4,S.reAuthenticate();case 4:return e.abrupt("return",e.sent);case 7:return r=t.email,a=t.password,e.next=10,S.authenticate({strategy:"local",email:r,password:a});case 10:return e.abrupt("return",e.sent);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),Error({message:"Failed to login user!"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}();var P=Object(i.b)((function(e){return{isBoardModalOpen:e.dashboard.boardModal}}))((function(e){var t=e.isBoardModalOpen,r=e.dispatch,c=Object(n.useState)(""),s=Object(O.a)(c,2),i=s[0],o=s[1],u=function(){r({type:"board-modal"})},l=function(){var e=Object(m.a)(f.a.mark((function e(t){var a,n,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,C();case 3:if(a=e.sent,n=a.client,!(i.length>0)){e.next=10;break}return e.next=8,n.service("boards").create({title:i});case 8:c=e.sent,r({type:"push-board",board:c});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(x.a,{isOpen:t,toggle:u,children:[Object(a.jsx)(g.a,{children:"Create New Board"}),Object(a.jsx)(v.a,{children:Object(a.jsx)(y.a,{onSubmit:l,children:Object(a.jsxs)(w.a,{children:[Object(a.jsx)(D.a,{for:"board-title",children:"Title"}),Object(a.jsx)(N.a,{type:"text",name:"title",id:"board-title",placeholder:"Enter board title!",required:!0,onChange:function(e){return o(e.target.value)}})]})})}),Object(a.jsxs)(k.a,{children:[Object(a.jsx)(d.a,{color:"primary",onClick:l,children:"Create"})," ",Object(a.jsx)(d.a,{color:"secondary",onClick:u,children:"Cancel"})]})]})}));var B=Object(i.b)((function(e){return{boards:e.dashboard.boards,mediaData:e.dashboard.mediaData,isbottomPanelOpen:e.dashboard.bottomPanel,isBoardModelOpen:e.dashboard.boardModel,user:e.auth.user}}))((function(e){var t=e.user,r=e.boards,n=e.mediaData,c=e.isbottomPanelOpen,s=e.dispatch,i=function(e,t){s({type:"handle-drop",item:e,board:t})};return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"ui",children:[Object(a.jsxs)("nav",{className:"navbar app",children:[Object(a.jsx)(d.a,{color:"primary",onClick:function(){return s({type:"bottom-panel"})},"aria-controls":"media-footer","aria-expanded":c,children:c?"Hide Media":" Show Media"}),Object(a.jsxs)("span",{children:["Welcome: ",t.email]}),Object(a.jsx)(d.a,{color:"primary",onClick:function(){S.logout(),s({type:"logout-user"}),s({type:"clear-storage"})},children:"Logout"})]}),Object(a.jsxs)("nav",{className:"navbar board",children:[Object(a.jsx)("span",{children:"Boards"}),Object(a.jsx)(d.a,{color:"primary btn-plus",onClick:function(){return s({type:"board-modal"})},children:"New board"})]}),Object(a.jsx)(P,{}),Object(a.jsx)("div",{className:"lists",children:r.map((function(e){return Object(a.jsx)(j,Object(o.a)(Object(o.a)({},e),{},{onUpdate:i}),e._id)}))})]}),Object(a.jsx)(u.a,{isOpen:c,children:Object(a.jsx)("div",{className:"footer",id:"media-footer",children:Object(a.jsx)("div",{className:"flex-container flex-wrap",children:n.map((function(e){return Object(a.jsx)(b,Object(o.a)({},e),e._id)}))})})})]})})),E=r(181),T=(r(168),function(){var e=Object(m.a)(f.a.mark((function e(){var t,r,a,n,c,s,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],r=[],e.next=4,C();case 4:if(a=e.sent,n=a.client,c=a.user,!n){e.next=25;break}return e.prev=8,e.next=11,n.service("boards").find();case 11:return s=e.sent,e.next=14,n.service("images").find();case 14:return i=e.sent,r=i.data.map((function(e){return e.type="media",e})),t=s.data.map((function(e){return e.tiles=[],e})),e.abrupt("return",{mediaImages:r,boards:t,jwt_user:c});case 20:return e.prev=20,e.t0=e.catch(8),e.abrupt("return",{mediaImages:r,boards:t,jwt_user:!1});case 23:e.next=26;break;case 25:return e.abrupt("return",{mediaImages:r,boards:t,jwt_user:!1});case 26:case"end":return e.stop()}}),e,null,[[8,20]])})));return function(){return e.apply(this,arguments)}}()),L=Object(i.b)((function(e){return{user:e.auth.user}}))((function(e){var t=e.dispatch,r=Object(n.useState)(""),c=Object(O.a)(r,2),s=c[0],i=c[1],o=Object(n.useState)(""),u=Object(O.a)(o,2),l=u[0],b=u[1],p=Object(n.useState)(""),j=Object(O.a)(p,2),h=j[0],x=j[1];return Object(a.jsxs)("div",{className:"pt-5",children:[Object(a.jsx)("h1",{className:"text-center",children:"Login"}),Object(a.jsx)("div",{className:"container",children:Object(a.jsx)("div",{className:"row",children:Object(a.jsx)("div",{className:"col-md-5 mx-auto",children:Object(a.jsxs)("div",{className:"card card-body",children:[Object(a.jsxs)(y.a,{onSubmit:function(e){(e.preventDefault(),s.length<=0||l.length<=0)?x("Email & password is required"):M({email:s,password:l}).then(function(){var e=Object(m.a)(f.a.mark((function e(r){var a,n,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"app-loading",state:!0}),e.next=3,T();case 3:a=e.sent,n=a.boards,c=a.mediaImages,t({type:"update-app-data",mediaImages:c,boards:n}),t({type:"app-loading",state:!1}),t({type:"login-user",user:r.user});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){x("Username/Password is invalid!")}))},children:[Object(a.jsxs)(w.a,{children:[Object(a.jsx)(D.a,{for:"exampleEmail",children:"Email"}),Object(a.jsx)(N.a,{type:"email",name:"email",id:"exampleEmail",placeholder:"with a placeholder",onChange:function(e){return i(e.target.value)}})]}),Object(a.jsxs)(w.a,{children:[Object(a.jsx)(D.a,{for:"examplePassword",children:"Password"}),Object(a.jsx)(N.a,{type:"password",required:!0,name:"password",id:"examplePassword",placeholder:"password placeholder",onChange:function(e){return b(e.target.value)}})]}),Object(a.jsx)(w.a,{children:Object(a.jsx)(d.a,{className:"btn-block",outline:!0,color:"primary",type:"submit",children:"Login"})})]}),h.length>0?Object(a.jsx)(E.a,{color:"danger",children:h}):"",Object(a.jsxs)("p",{className:"small-xl pt-3 text-center",children:[Object(a.jsx)("span",{className:"text-muted",children:"Not a member?"}),Object(a.jsx)("a",{href:"#",children:"Sign up"})]})]})})})})]})}));r(169);var J=Object(i.b)((function(e){return{isLoading:e.root.loading,user:e.auth.user}}))((function(e){e.isLoading;var t=e.user;return e.dispatch,t?Object(a.jsx)(B,{}):Object(a.jsx)(L,{})})),q=r(23),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"app-loading":return Object(o.a)(Object(o.a)({},e),{},{loading:t.state});default:return e}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"login-user":return{user:t.user};case"logout-user":return{user:!1};default:return e}},F=r(82),H=function(e,t,r){var a=function(e,t){return e.map((function(e){return e._id===t.boardId?(e.tiles=e.tiles.filter((function(e){return e._id!==t._id})),e):e}))}(e.boards,t).map((function(e){if(e._id===r._id){var a=Object(o.a)(Object(o.a)({},t),{},{boardId:r._id});return e.tiles.push(a),e}return e})),n=e.mediaData;return void 0!==typeof t.type&&"media"===t.type&&(n=n.filter((function(e){return e._id!==t._id}))),Object(o.a)(Object(o.a)({},e),{},{boards:a,mediaData:n})},R={boards:[],mediaData:[],bottomPanel:!1,boardModal:!1},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"handle-drop":return H(e,t.item,t.board);case"update-app-data":return Object(o.a)(Object(o.a)({},e),{},{mediaData:t.mediaImages,boards:t.boards});case"bottom-panel":return Object(o.a)(Object(o.a)({},e),{},{bottomPanel:!e.bottomPanel});case"board-modal":return Object(o.a)(Object(o.a)({},e),{},{boardModal:!e.boardModal});case"push-board":var r=Object(F.a)(e.boards),a=t.board;return a.tiles=[],r.push(a),Object(o.a)(Object(o.a)({},e),{},{boards:r,boardModal:!1});case"clear-storage":return R;default:return e}},z=Object(q.b)({root:U,auth:A,dashboard:W}),G=r(80),K=r.n(G),Q=function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),V=Object(q.c)(z,Q);V.subscribe(K()((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(r){}}(V.getState())}),1e3));var X=V,Y=r(81),Z=r(182);s.a.render(Object(a.jsx)(i.a,{store:X,children:Object(a.jsx)(Z.a,{backend:Y.a,children:Object(a.jsx)(J,{})})}),document.getElementById("root"))},93:function(e,t,r){},95:function(e,t,r){},96:function(e,t,r){},97:function(e,t,r){},98:function(e,t,r){}},[[170,1,2]]]);
//# sourceMappingURL=main.190c50ed.chunk.js.map